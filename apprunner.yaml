version: 1.0
runtime: python3
build:
  commands:
    build:
      - pip install -r requirements.txt
run:
  command: bash -c "if [ \"$INIT_DB\" = \"true\" ]; then python init_sample_data.py; fi && streamlit run 1_Dashboard.py --server.port=8080 --server.address=0.0.0.0"
  network:
    port: 8080
    env: APP_PORT
  env:
    - name: PYTHONUNBUFFERED
      value: "1"
    - name: PYTHONDONTWRITEBYTECODE
      value: "1"
  service_role: AppRunnerECRAccessRole
health_check:
  path: "/_stcore/health"
  interval: 30
  timeout: 5
  healthy_threshold: 1
  unhealthy_threshold: 5
instance_configuration:
  cpu: 1
  memory: 2048 